{"version":3,"sources":["webpack:///./src/components/users/Auth.vue?ece0","webpack:///src/components/users/Auth.vue","webpack:///./src/components/users/Auth.vue?5baa","webpack:///./src/components/users/Auth.vue","webpack:///./src/components/users/Auth.vue?1fa9"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","_v","attrs","directives","name","rawName","value","user","expression","ref","domProps","on","$event","type","indexOf","_k","keyCode","key","resetPassword","target","composing","$set","confirmPwd","_s","message","_e","staticRenderFns","component"],"mappings":"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","file":"js/chunk-542551f2.29f60151.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"col-lg-6 mx-auto p-4\",staticStyle:{\"border\":\"1px solid lightgray\",\"margin-top\":\"8em\",\"margin-bottom\":\"8em\",\"height\":\"100%\",\"padding-top\":\"2rem\",\"padding-bottom\":\"2rem\"}},[_c('form',{staticClass:\"px-4 py-3\"},[_c('div',{staticClass:\"form-group\"},[_c('span',{staticClass:\"font-weight-bold\",staticStyle:{\"font-size\":\"2rem\"}},[_vm._v(\"비밀번호 재설정\")]),_c('hr',{staticClass:\"solid\"}),_c('label',{attrs:{\"for\":\"exampleDropdownFormEmail1\"}},[_vm._v(\"비밀번호\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.user.pwd),expression:\"user.pwd\"}],ref:\"pwd\",staticClass:\"form-control\",attrs:{\"type\":\"password\",\"placeholder\":\"비밀번호를 입력해주세요.\"},domProps:{\"value\":(_vm.user.pwd)},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.resetPassword($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.user, \"pwd\", $event.target.value)}}})]),_c('div',{staticClass:\"form-group\"},[_c('label',{attrs:{\"for\":\"exampleDropdownFormPassword1\"}},[_vm._v(\"비밀번호 재입력\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.confirmPwd),expression:\"confirmPwd\"}],ref:\"confirmPwd\",staticClass:\"form-control\",attrs:{\"type\":\"password\",\"placeholder\":\"비밀번호를 다시 입력해주세요.\"},domProps:{\"value\":(_vm.confirmPwd)},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.resetPassword($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.confirmPwd=$event.target.value}}})]),_c('button',{staticClass:\"btn btn-primary btn-lg btn-block\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.resetPassword}},[_vm._v(\"비밀번호 재설정\")])]),_c('div',{staticClass:\"dropdown-divider\"}),(_vm.errors)?_c('div',{staticClass:\"alert alert-danger text-center\",staticStyle:{\"margin-top\":\"1rem\"},attrs:{\"role\":\"alert\"}},[_vm._v(\" \"+_vm._s(_vm.message)+\" \")]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"col-lg-6 mx-auto p-4\"\r\n        style=\"border:1px solid lightgray;margin-top:8em;margin-bottom:8em;height:100%;padding-top:2rem;padding-bottom:2rem;\">\r\n        <form class=\"px-4 py-3\">\r\n            <div class=\"form-group\">\r\n                <span class=\"font-weight-bold\" style=\"font-size:2rem;\">비밀번호 재설정</span>\r\n                <hr class=\"solid\">\r\n                <label for=\"exampleDropdownFormEmail1\">비밀번호</label>\r\n                <input type=\"password\" class=\"form-control\" ref=\"pwd\" v-model=\"user.pwd\" placeholder=\"비밀번호를 입력해주세요.\" \r\n                    @keyup.enter=\"resetPassword\">\r\n            </div>\r\n            <div class=\"form-group\">\r\n                <label for=\"exampleDropdownFormPassword1\">비밀번호 재입력</label>\r\n                <input type=\"password\" class=\"form-control\" ref=\"confirmPwd\" v-model=\"confirmPwd\" placeholder=\"비밀번호를 다시 입력해주세요.\" \r\n                    @keyup.enter=\"resetPassword\">\r\n            </div>\r\n            <button type=\"button\" class=\"btn btn-primary btn-lg btn-block\" @click=\"resetPassword\">비밀번호 재설정</button>\r\n        </form>\r\n        <div class=\"dropdown-divider\"></div>\r\n        <div class=\"alert alert-danger text-center\" role=\"alert\" v-if=\"errors\" style=\"margin-top:1rem;\">\r\n            {{ message }}\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\n  /* eslint-disable no-unused-vars */\r\nimport store from '@/store'\r\nimport router from '@/router/routes'\r\nimport axios from 'axios'\r\nimport { mapState } from 'vuex'\r\n  export default {\r\n    name: 'Auth',\r\n    data() {\r\n      return {\r\n        errors: '',\r\n        message: '',\r\n        user: {\r\n            pwd: '',\r\n        },\r\n        confirmPwd: '',\r\n        toke: '',\r\n      }\r\n    },\r\n    methods: {\r\n        checkForm() {\r\n\r\n            const check = ref => {\r\n                if(!ref.value) {\r\n                    this.errors = true;\r\n                    this.message = '비밀번호를 입력해주세요';\r\n                    ref.focus();\r\n                    return false;\r\n                } else {\r\n                    this.errors = false;\r\n                    this.message = '';\r\n                    return true;\r\n                }\r\n            }\r\n\r\n            let result = check(this.$refs.pwd);\r\n            if(!result) return false;\r\n\r\n            result = check(this.$refs.confirmPwd);\r\n            if(!result) return false;\r\n\r\n            if(this.$refs.pwd.value !== this.$refs.confirmPwd.value) {\r\n                this.errors = true;\r\n                this.message = ('비밀 번호가 일치하지 않습니다.');\r\n                return false;\r\n            } \r\n            \r\n            return true;\r\n        },\r\n        resetPassword() {\r\n            // console.log(this.$refs.confirmPwd.value)\r\n            const check = this.checkForm();\r\n            if(!check) return false;\r\n            else {\r\n                this.errors = false;\r\n                this.message = false;\r\n            }\r\n            console.log('다통과');\r\n\r\n            const config = { headers: { authorization: this.token }};\r\n            (async () => {\r\n                try {\r\n                    const response = \r\n                        await this.$axios.patch(`${ this.url }/users/updatePwd`, this.user, config);\r\n                    \r\n                    const { code, message } = response.data;\r\n                    if(code === 200) {\r\n                        alert(message);\r\n                        this.user.pwd = '';\r\n                        this.confirmPwd = '';\r\n                    } else {\r\n                        // 서버에러 처리\r\n                        alert(message);\r\n                    }\r\n                } catch(err) {\r\n                    console.log(err);\r\n                }\r\n            })();\r\n        }\r\n    },\r\n    computed:{\r\n      ...mapState(['id', 'userId', 'url'])\r\n    },\r\n    created() {\r\n        const token = this.$route.params.token;\r\n        console.log('파라미터', token);\r\n        this.token = token;\r\n        // 서버에 토큰 인증 요청 \r\n        // 인증 성공하면 그대로 비번설정 진행\r\n        // 실패하면 리다이렉트(resetpwd로)\r\n        const config = { headers: { authorization: token }};\r\n       (async () => {\r\n           try {\r\n                const respnase = \r\n                    await this.$axios.get(`${ this.url }/users/authToken`, config);\r\n\r\n                const { code, message } = respnase.data;\r\n                console.log('토큰 인증결과 코드', code);\r\n                if(code !== 200) this.$router.push(\r\n                    { name: 'passwordreset', query: { token: 'Expired' }}\r\n                );\r\n           } catch(err) {   \r\n               console.log(err);\r\n           }\r\n       })();\r\n    },\r\n    beforeRouteEnter(to, from, next) {\r\n        // 이 단계에서 토큰을 검증하여\r\n        // 토큰이 유효하지 않다면 리다이렉트 하여비밀번호 설정을 보여주지X\r\n        // 로그인 되어 있을 경우에는 profile로 유도\r\n        store.getters.getloginState\r\n            ? router.push({ name: 'profile'})\r\n            : next()\r\n    }\r\n  }\r\n</script>\r\n<style>\r\n    .margin-control {\r\n        margin-right: 0px;\r\n    }\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Auth.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Auth.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Auth.vue?vue&type=template&id=45510fd0&\"\nimport script from \"./Auth.vue?vue&type=script&lang=js&\"\nexport * from \"./Auth.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Auth.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Auth.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Auth.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}